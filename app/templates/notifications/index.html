{% extends "base.html" %}
{% block title %}Notifications - {{ site_settings.get('site_name', 'Chirp') }}{% endblock %}
{% block content %}
{% from "components/icons.html" import icon %}
<div class="page-container">
    <div class="page-header">
        <h2>Notifications</h2>
    </div>

    <div class="notifications-list">
        {% for notif in notifications %}
        <div class="notification-item {% if not notif.is_read %}unread{% endif %}">
            {% if notif.actor_pic %}
            <img src="{{ notif.actor_pic or url_for('static', filename='img/default-avatar.svg') }}" alt="" class="avatar-sm">
            {% endif %}
            <div class="notif-content">
                {% set notif_icons = {
                    'like': 'favorite',
                    'follow': 'person_add',
                    'reply': 'reply',
                    'repost': 'repeat',
                    'mention': 'alternate_email',
                    'message': 'mail'
                } %}
                {{ icon(notif_icons.get(notif.type, 'notifications'), 'notif-icon') }}
                <div>
                    {% if notif.actor_name %}
                    <a href="{{ url_for('auth.profile', username=notif.actor_name) }}"><strong>{{ notif.actor_display or notif.actor_name }}</strong></a>
                    {% endif %}
                    {% if notif.type == 'like' %}liked your chirp
                    {% elif notif.type == 'follow' %}followed you
                    {% elif notif.type == 'reply' %}replied to your chirp
                    {% elif notif.type == 'repost' %}rechirped your chirp
                    {% elif notif.type == 'mention' %}mentioned you
                    {% elif notif.type == 'message' %}{{ notif.message }}
                    {% else %}{{ notif.message }}{% endif %}
                    {% if notif.post_content %}
                    <p class="notif-post-preview">{{ notif.post_content[:80] }}</p>
                    {% endif %}
                    <small class="notif-time">{{ notif.created_at[:16] }}</small>
                </div>
            </div>
            {% if notif.post_id %}
            <a href="{{ url_for('posts.view_post', post_id=notif.post_id) }}" class="notif-link">
                {{ icon('chevron_right') }}
            </a>
            {% endif %}
        </div>
        {% else %}
        <div class="empty-state">
            {{ icon('notifications_off') }}
            <p>No notifications yet</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
